(this["webpackJsonpmy-app"]=this["webpackJsonpmy-app"]||[]).push([[0],{127:function(e,t,n){},128:function(e,t,n){},237:function(e,t,n){"use strict";n.r(t);var a=n(8),o=n(0),r=n.n(o),i=n(24),s=n.n(i),c=(n(127),n(43)),l=(n(128),n(129),n(116)),u=n(243),d=n(241),j=n(242),h=n(118),m=function(e){var t=Object(o.useState)(),n=Object(c.a)(t,2),r=n[0],i=n[1];return Object(o.useEffect)((function(){if(r){var t={method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(r)};fetch("https://tager.dev.ozitag.com/api/auth/user/",t).then((function(e){return e.json()})).then((function(t){void 0!==t.data.accessToken&&(console.log("response login API",t),localStorage.setItem("accessToken",t.data.accessToken),localStorage.setItem("refreshToken",t.data.refreshToken),e.isLogined(!0))})).catch((function(e){u.b.error("\u0412\u0432\u0435\u0434\u0435\u043d\u044b \u043d\u0435 \u043f\u0440\u0430\u0432\u0435\u043b\u044c\u043d\u044b\u0435 \u0434\u0430\u043d\u043d\u044b\u0435")}))}}),[r,e]),Object(a.jsx)("div",{className:"Container",children:Object(a.jsx)(l.a,{initialValues:{email:"user@ozitag.com",password:"user"},validate:function(e){var t={};return e.email?/^[A-Z0-9._%+-]+@[A-Z0-9.-]+\.[A-Z]{2,}$/i.test(e.email)||(t.email="Invalid email address"):t.email="Required",e.password||(t.password="Required"),console.log("errors: ",t),t},onSubmit:function(e,t){var n=t.setSubmitting;e.clientId=1,console.log("onSubmit values: ",e),i(e),n(!1)},children:function(e){var t=e.values,n=e.errors,o=e.touched,r=e.handleChange,i=e.handleBlur,s=e.handleSubmit,c=e.isSubmitting;return Object(a.jsxs)("form",{onSubmit:s,children:[Object(a.jsx)(d.a.Item,{label:"Email",validateStatus:void 0!==n.email?"error":"",help:n.email&&o.email&&n.email,required:"true",children:Object(a.jsx)(j.a,{type:"email",name:"email",onChange:r,onBlur:i,value:t.email})}),Object(a.jsx)(d.a.Item,{label:"Password",validateStatus:void 0!==n.password?"error":"",help:n.password&&o.password&&n.password,required:"true",children:Object(a.jsx)(j.a,{type:"password",name:"password",onChange:r,onBlur:i,value:t.password})}),Object(a.jsx)(h.a,{type:"primary",htmlType:"submit",disabled:c,children:"Submit"})]})}})})},b=n(244),p=n(240),f=function(e){var t=Object(o.useState)(!1),n=Object(c.a)(t,2),r=n[0],i=n[1];Object(o.useEffect)((function(){if(r){var t={method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer "+localStorage.getItem("accessToken")}};fetch("https://tager.dev.ozitag.com/api/tager/user/profile/logout/",t).then((function(e){return e.json()})).then((function(t){console.log(t),t.success&&(e.isLogined(!1),localStorage.clear())}))}}),[r,e]);return Object(a.jsxs)("div",{children:[e.userProfile?Object(a.jsxs)(a.Fragment,{children:[Object(a.jsx)("h4",{children:"UserPage"}),Object(a.jsxs)("p",{children:["name: ",e.userProfile.name]}),Object(a.jsxs)("p",{children:["email: ",e.userProfile.email]})]}):Object(a.jsx)(b.b,{children:Object(a.jsx)(p.a,{size:"large"})}),Object(a.jsx)(h.a,{type:"primary",onClick:function(){i(!0)},children:"\u0412\u044b\u0439\u0442\u0438"})]})},g=function(){var e=Object(o.useState)(null),t=Object(c.a)(e,2),n=t[0],r=t[1],i=Object(o.useState)(!1),s=Object(c.a)(i,2),l=s[0],u=s[1];Object(o.useEffect)((function(){if((null===n||!l)&&localStorage.getItem("accessToken")){var e={method:"GET",headers:{"Content-Type":"application/json",Authorization:"Bearer "+localStorage.getItem("accessToken")}};fetch("https://tager.dev.ozitag.com/api/tager/user/profile/",e).then((function(e){return e.json()})).then((function(e){console.log(e),u(e.data),r(!0)}))}}),[n]);var d=function(e){r(e)};return Object(a.jsx)("div",{className:"container",children:n?Object(a.jsx)(f,{isLogined:d,userProfile:l}):Object(a.jsx)(m,{isLogined:d})})},O=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,245)).then((function(t){var n=t.getCLS,a=t.getFID,o=t.getFCP,r=t.getLCP,i=t.getTTFB;n(e),a(e),o(e),r(e),i(e)}))};n(235);s.a.render(Object(a.jsx)(r.a.StrictMode,{children:Object(a.jsx)(g,{})}),document.getElementById("root")),O()}},[[237,1,2]]]);
//# sourceMappingURL=main.ecacd8f5.chunk.js.map